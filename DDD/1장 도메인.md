
### 1.1 도메인이란?

소프트웨어로 해결하고자 하는 문제 영역

<img width="1440" height="692" alt="image" src="https://github.com/user-attachments/assets/2cf5eb1a-fa87-4e26-96e5-86b73ba09ac3" />


### 1.2 도메인 전문가와 개발자와의 소통

도메인 전문가와 소통하여 올바르게 요구사항을 이해할 것

### 1.3 도메인 모델

특정 도메인을 개념적으로 표현할 것

- 객체 기반 도메인 모델 : 데이터과 기능을 정리하기 때문에 도메인을 정리하는데 적합하다.
- 상태 다이어그램, 클래스 다이그램과 같은 UML
- 관계가 중요하다면 그래프, 수학 공식 등 다양하게 표현 가능

실제로 채팅 솔루션을 제로베이스에서 구현하면서

위와 같은 문서화가 진행되지 않으면 요구사항이 데이터 기반으로 정리되지 않음을 느꼈다.

![Uploading image.png…]()


근데 객체 기반 도메인 모델을 그리지 않았어서 현재 코드 상에서 도메인 로직이 퍼지게 되었다.

새로운 요구사항이 생길 때 영향도가 넓게 퍼져 있는 문제가 발생하고 있음을 느낀다. 

리팩토링을 통해서 고칠 예정이다.

### 1.4 도메인 모델 패턴

일반적이 애플리케이션 아키텍처

- 유저
- 표현계층
- 응용계층
- 도메인 계층
- 인프라아키테거
- DB

여기서 말하는 도메인 모델 패턴 

= 아키텍처 상의 도메인 모델을 객체 기향 기법으로 표현하는 패던

핵심 규칙을 구현한 코드는 도메인 모델에만 존재

규칙이 바뀌거나 규칙을 확장해야할 때 다른 코드에 영향을 주지 않는다. 

### 1.5 도메인 모델 도출

- 요구 사항을 통해서 도메인과 도메인을 이루는 값, 관계를 정의한다. 일을 진행하면 더 점진적으로 진행
- 코드 자체가 문서화가 되기 위해서는 도메인 관점에서 잘 표현해야 할 것

### 1.6 엔티티와 벨류

- 엔티티
    - 식별자를 가진다. : 주문에서 배송이 취소되거나 상태가 바뀌더라도 주문번호가 바뀌지 않는다. = 채팅에서 채팅 상태가 바뀌거나 고객 종료 혹은 설계사가 종료하더라도 채팅방 번호를 바뀌지 않는다.
    - 식별자 생성 방식
        - 특정 규칙
        - UUID나 NanoID
        - 값을 직접 사용자가 입력
        - 일련번호 (시퀀스가 DB를 통해서)
    - 식별자를 이용한 equals()와 hashCode()
- 밸류
    
    ```java
    public class ShoppingInfo {
       // 받는 사람
       private String receiverName;
       private String receiverNumber;
       
       // 주소
       private String shippingAddress1;
       private String shippingAddress2;
       private String shippingZipCode;
    
    }
    ```
    
    - Value 타입은 개념적으로 완전히 하나로 표현될 수 있다. (그렇다고 해서 여러 개의 필드를 가질 필요는 없다.)
        
        ```java
        public class Receiver {
          private String name;
          private String phoneNumber;
        }
        ```
        
        ```java
        public class Address {
          private String address1;
          private String address2;
          private String zipCode;
        
        }
        ```
        
        ```java
        public class ShoppingInfo {
           // 받는 사람
           private Receiver receiver;
           
           // 주소
           private Address address;
        }
        ```
        
    - Value 타입의 장점
        - 완전히 하나로 표현된다.
        - 밸류 타입을 위한 기능을 추가할 수 있다.
    - Value 타입을 불편으로 설정하자 그래야 안전한 코드를 작성할 수 있다.
        - 생성자를 통해서 만들지 않고 Set을 통해서 만들어 버리면 Value 타입을 검증, 혹은 비즈니스 로직을 타지 않고 만들어지기 때문에 도메인 규칙이 깨질 수 있음.
        - 생성자에 해당 Value의 검증이나 해당 도메인의 검증이 이루어지기 때문에 값을 변경하는 경우에는 Set이 아닌 새로운 객체를 생성하도록 하자.
        
        ```java
        Money price = new Money(1000);
        OrderLine line = new OrderLine(product, price,2); // amount = 2*1000 = 2000
        price.setValue(2000); // amount = 2*1000 = 2000 그대로 2000이 됨
        
        ```
        
    - 도메인 모델에 Set을 넣지 말자.
        - setAmount() 는 그냥 Amount를 설정하는 것, 따라서 계산 로직 즉 price와 주문한 수량을 곱해서 만들어지는 amount를 로직을 넣는 것이 어색해진다.
        - 도메인 객체가 불완전한 상태를 막으려면 생성 시점에서 필요한 것을 모두 주고 만들 것 즉 생성자를 통해서 만들자.
        - 그리고 Set을 외부로 노출하지 않고 내부에서 사용하도록 private으로 할 것
        - 불변 밸류 타입으로 설정하여 자연스럽게 Set을 호출하지 않도록 할 것
    
    ### 1.7 도메인 용어와 유비쿼터스 용어
    
    도메인 전문가, 기획자, 개발자 모두 같은 용어를 사용하여 소통 과정에서 발생하는 모호함을 줄일 것,
    
    개발자는 도메인과 코드 사이에서 불필요한 해석을 줄일 수 있다. 
    
    도메인 용어에 알맞는 단어를 찾는 것에 시간을 아끼지 말 것
